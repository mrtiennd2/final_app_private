<div
  style='width: 200px; color: lightgray; height: 200px; border: 3px dashed gray;'
  class='rounded-lg d-flex justify-content-center align-items-center position-relative bg-light'
>
  <p class='position: absolute' style='font-weight: bold; font-size: 5rem'>+</p>

  <% display_check = (controller_name == "photos" && action_name == "new" && defined?(photo)) || controller_name == "albums" ? 'd-none' : 'd-block' %>

  <img
    src="<%= defined?(photo) && photo.image_url.url %>"
    class="preview__image w-100 h-100 <%= display_check %> position-absolute"
  />

  <%= form.label file_field_name, "+", class: "position-absolute h1 w-100 h-100 d-flex justify-content-center align-items-center", style: "select: none; color: transparent; background: transparent; cursor: pointer; z-index: 2" %>
  <%= form.file_field file_field_name, multiple: false, class: "sr-only file__input" %>

  <button
    type='button'
    class="remove__image__btn btn d-none <%= display_check %>"
    style='position: absolute; top: 0; right: 0; z-index: 10; font-size: 1.5rem; color: lightgray; background: transparent;'
  >
    <i class="fa-solid fa-xmark"></i>
  </button>
</div>

<script>
  (function() {
    const fileInput = document.querySelector('.file__input');
    const image = document.querySelector('.preview__image');
    const removeImageBtn = document.querySelector('.remove__image__btn');

    fileInput.addEventListener('change', (e) => {
      if (e.target.files.length) {
        const src = URL.createObjectURL(e.target.files[0]);
        image.src = src;
        image.classList.remove('d-none');
        removeImageBtn.classList.remove('d-none');
      }
    });

    removeImageBtn.addEventListener('click', () => {
      fileInput.value = "";
      fileInput.files = null;
      image.src = "";
      image.classList.remove('d-block');
      image.classList.add('d-none');
      removeImageBtn.classList.remove('d-block');
      removeImageBtn.classList.add('d-none');
    });
  })();
</script>

